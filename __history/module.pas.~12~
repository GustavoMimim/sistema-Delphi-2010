unit module;

interface

uses
  Forms, Dialogs, SysUtils, Classes, DB, ADODB, IniFiles;

type
  TDm = class(TDataModule)
    sqlCity: TADOQuery;
    ADOConnection1: TADOConnection;
    procedure DataModuleCreate(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Dm: TDm;

implementation

{$R *.dfm}

procedure TDm.DataModuleCreate(Sender: TObject);
var
 conf: TIniFile;
 strConn: String;

begin
  conf := TIniFile.Create(extractfilepath(ParamStr(0))+'conf.ini'); {loja.ini é o nome do arquivo criado na pasta de seu programa}

  strConn := conf.ReadString('access', 'stringConnection', 'Provider=SQLNCLI11.1;Integrated Security=SSPI;Persist Security Info=False;User ID="";Initial Catalog="";Data Source=localhost;Initial File Name="";Server SPN=""');

  ADOConnection1.ConnectionString := strConn;

  Try
    ADOConnection1.Open();
  Except on E: Exception do
    begin
      ShowMessage('Não foi possível se conectar ao banco de dados.' +  #13 + 'Erro: ' + E.Message + #13 + 'Tente alterar a string de conexão em ./conf.ini.');
      Application.Terminate;
    end;
  end;

end;

end.
